import { CalendarPage } from './Calendar';
import { Tasks } from './Tasks';
import { Statistics } from './Statistics';
import { Settings } from './Settings';
import { Accounting } from './Accounting';
import { Constants } from '../common/Constants';

/**
 * ä¸»é¡µé¢ - åŒ…å«åº•éƒ¨å¯¼èˆªæ 
 */
@Entry
@Component
struct Main {
  @State currentIndex: number = 0;
  @State tabs: TabContent[] = [];

  aboutToAppear() {
    this.initTabs();
  }

  /**
   * åˆå§‹åŒ–æ ‡ç­¾é¡µ
   */
  initTabs(): void {
    this.tabs = [
      {
        title: 'æ—¥å†',
        icon: 'ğŸ“…',
        component: CalendarPage
      },
      {
        title: 'ä»»åŠ¡',
        icon: 'ğŸ“‹',
        component: Tasks
      },
      {
        title: 'è®°è´¦',
        icon: 'ğŸ’°',
        component: Accounting
      },
      {
        title: 'ç»Ÿè®¡',
        icon: 'ğŸ“Š',
        component: Statistics
      },
      {
        title: 'è®¾ç½®',
        icon: 'âš™ï¸',
        component: Settings
      }
    ];
  }

  /**
   * åˆ‡æ¢æ ‡ç­¾é¡µ
   */
  onTabChange(index: number): void {
    this.currentIndex = index;
  }

  build() {
    Column() {
      // å†…å®¹åŒºåŸŸ
      Column() {
        if (this.currentIndex === 0) {
          CalendarPage()
        } else if (this.currentIndex === 1) {
          Tasks()
        } else if (this.currentIndex === 2) {
          Accounting()
        } else if (this.currentIndex === 3) {
          Statistics()
        } else {
          Settings()
        }
      }
      .layoutWeight(1)
      .width('100%')

      // åº•éƒ¨å¯¼èˆªæ 
      Row() {
        ForEach(this.tabs, (tab: TabContent, index: number) => {
          Column() {
            Text(tab.icon)
              .fontSize(24)
              .margin({ bottom: 4 })
            Text(tab.title)
              .fontSize(12)
              .fontColor(
                this.currentIndex === index
                  ? Constants.COLOR_PRIMARY
                  : Constants.COLOR_TEXT_SECONDARY
              )
          }
          .layoutWeight(1)
          .justifyContent(FlexAlign.Center)
          .padding({ top: 8, bottom: 8 })
          .onClick(() => {
            this.onTabChange(index);
          })
        })
      }
      .width('100%')
      .height(60)
      .backgroundColor(Constants.COLOR_CARD_BACKGROUND)
      .border({ width: { top: 1 }, color: Constants.COLOR_DIVIDER })
      .padding({ bottom: 0 })
    }
    .width('100%')
    .height('100%')
    .padding({ top: 0 })
  }
}

/**
 * æ ‡ç­¾é¡µå†…å®¹æ¥å£
 */
interface TabContent {
  title: string;
  icon: string;
  component: ESObject;
}

